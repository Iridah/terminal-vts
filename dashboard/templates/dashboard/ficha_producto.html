<!-- dashboard/templates/dashboard/ficha_producto.html -->
{% extends 'dashboard/base.html' %}

{% block content %}
<div style="padding: 10px;">
    <div style="margin-bottom: 25px; display: flex; align-items: center; gap: 15px;">
        <a href="{% url 'inventario' %}" style="text-decoration: none; color: #4B49AC; font-weight: bold;">
            <i class="fa-solid fa-arrow-left"></i> Volver a La Forja
        </a>
        <h2 style="margin: 0; color: #2D2D2D;">Ficha Técnica: {{ item.sku }}</h2>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 30px;">
        <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); text-align: center;">
            <div style="width: 150px; height: 150px; background: #F5F7FF; border-radius: 20px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center;">
                <i class="fa-solid fa-box-open" style="font-size: 4em; color: #4B49AC;"></i>
            </div>
            <h3 style="margin-bottom: 5px;">{{ item.producto }}</h3>
            <span style="background: #E8E7FD; color: #4B49AC; padding: 5px 15px; border-radius: 10px; font-weight: bold;">
                {{ item.seccion }}
            </span>
            <hr style="margin: 25px 0; border: 0; border-top: 1px solid #eee;">
            
            <div style="display: flex; justify-content: space-around;">
                <div>
                    <small style="display: block; color: #6C7383;">Estado Stock</small>
                    {% with status=item.get_stock_status %}
                    <strong style="color: {{ status.color }};">{{ status.texto }}</strong>
                    {% endwith %}
                </div>
                <div>
                    <small style="display: block; color: #6C7383;">Rentabilidad</small>
                    {% with m_status=item.get_rentabilidad_status %}
                    <strong style="color: {{ m_status.color }};">{{ m_status.texto }}</strong>
                    {% endwith %}
                </div>
            </div>
        </div>

        <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.05);">
            <h4 style="color: #4B49AC; border-bottom: 2px solid #F5F7FF; padding-bottom: 10px; margin-bottom: 20px;">
                Datos de Auditoría Live
            </h4>
            <form action="{% url 'actualizar_inventario' item.sku %}" method="POST">
                {% csrf_token %}
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <div>
                        <label style="font-weight: 600;">Costo Neto ($)</label>
                        <input type="number" step="0.01" name="costo" value="{{ item.precio_costo }}" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #eee;">
                    </div>
                    <div>
                        <label style="font-weight: 600;">Precio Venta ($)</label>
                        <input type="number" step="0.01" name="precio" value="{{ item.precio_venta }}" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #eee;">
                    </div>
                </div>
                
                <button type="submit" style="width: 100%; margin-top: 20px; background: #4B49AC; color: white; padding: 15px; border-radius: 10px; border: none; font-weight: bold;">
                    Actualizar Datos Maestros
                </button>
            </form>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div>
                    <label>Costo Neto ($)</label>
                    <input type="number" step="0.01" name="costo" value="{{ item.costo_neto }}" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #eee;">
                </div>
                <div>
                    <label>Precio Venta ($)</label>
                    <input type="number" step="0.01" name="precio" value="{{ item.precio_venta }}" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #eee;">
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}